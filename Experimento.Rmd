---
title: "Experimento"
author: "Viviane Sanchez"
date: "10/17/2020"
output: html_document
---

```{r setup, include=FALSE}

library(tidyverse)
library(moments)
library(DescTools)
library(skimr)
library(lubridate)
library(janitor)
library(ggpubr)
library(ggpmisc)

today <- Sys.Date()

theme_set(theme_minimal())
theme_update(#text = element_text(family = ""),
             plot.title = element_text(face = "bold", size = 16))
```

# Dados

```{r}

load("data/experimento_mat.RData")

skim(experimento_mat)

exp_raw <- experimento_mat %>% 
  as_tibble() %>% 
  clean_names() %>% 
  na.omit()

exp <- exp_raw %>% 
  mutate(idade = year(today) - ano_nascto,
         faixa_et = as_factor(ntile(idade, 5)))

exp_pivot <- exp %>% 
  pivot_longer(cols = c(renda, escolaridade, est_civil, faixa_et),
                        names_to = "caract",
                        values_to = "grupo_caract")

```

# Análise

## Diferenças entre características

```{r}

p_est <- exp %>% 
  tabyl(est_civil, iv_materia_patr) %>% 
  chisq.test()

p_esc <- exp %>% 
  tabyl(escolaridade, iv_materia_patr) %>% 
  chisq.test()

p_renda <- exp %>% 
  tabyl(renda, iv_materia_patr) %>% 
  chisq.test()

p_idade <- exp %>% 
  tabyl(faixa_et, iv_materia_patr) %>% 
  chisq.test()

p_values <- tibble(
  label = c(p_esc$p.value, p_est$p.value, p_renda$p.value, p_idade$p.value),
  caract   = c("escolaridade", "est_civil", "renda", "faixa_et"),
  x = c("4", "3", "4", "3"),
  y = 50,
  iv_materia_patr = 0)

exp_pivot %>% 
  group_by(caract, grupo_caract, iv_materia_patr) %>% 
  count() %>% 
  ggplot(aes(grupo_caract, n, fill = if_else(iv_materia_patr == 0, "Não", "Sim"))) +
  geom_col(position = "dodge") +
  facet_wrap(~caract, scales = "free_x") +
  theme(legend.position = "bottom") +
  labs(x = "Grupo", y = "Quantidade", fill = "Patrocinado?") +
  geom_text(data = p_values,
            mapping = aes(x = x, y = y, 
                          label = paste("p-valor:",
                                        round(label, 4))))

```

Considerando os p-valores do teste qui-quadrado para cada grupo, não é possível afirmar que existe uma diferença entre eles.

## Verificação de Hipóteses

O fato da matéria ser patrocinada: 
- A: diminui a credibilidade da blogueira e 
- B: a atitude com relação à marca que patrocinou. 
- C: pessoas mais envolvidas com o produto são menos afetadas por esse tipo de matéria.

AS HIPÓTESES (A), (B) E (C) SÃO SUPORTADAS PELOS NOSSOS DADOS? JUSTIFIQUE POR MEIO DE TÉCNICAS INFERENCIAIS ADEQUADAS (PODE SER TH, ANOVA OU REGRESSÃO)

H0 : Não existe associação entre as variáveis (grupos são semelhantes quanto a esta variável) H1 : Existe associação entre as variáveis (grupos diferem quanto a esta variável)

```{r}

#labs(x = "Grupo", y = "Quantidade", fill = "Patrocinado?") +
#n  stat_compare_means(method = "t.test")


```
